const SimpleMap=(()=>{const t=(()=>{let t={},e=null,r=(e,r)=>{t[e]=a(r)},l=r=>{if(!t[r])throw new Error("There is no loaded data for "+e);e=r},a=t=>{let e=t.split("|"),r=t=>parseInt(t,16),l=r(e[0]),a=r(e[1]),o=[];for(let t=0;t<l;t++){let r=e[t+2].split(","),l=[],a=r.length;if(a>1)for(let t=0;t<a;t+=3){let e=r[t],a=parseInt(r[t+1],16),o=parseInt(r[t+2],16)+1;l.push({country:e,yStart:a,yEnd:o})}o.push(l)}return{width:l,height:a,grid:o}};return r("none","1|1||"),l("none"),{getData:()=>t[e],setActiveView:l,loadData:r}})();return Object.freeze({loadData:(e,r)=>t.loadData(e,r),create:(e,r)=>{let l=(()=>{let e=document.createElement("canvas"),r=null,l={};return{setRasterSize:(t,l)=>{e.width=t,e.height=l,r=e.getContext("2d")},refreshData:()=>{let r=t.getData(),a=r.width,o=r.height,n=r.grid;l={};let{width:i,height:s}=e;for(let t=0;t<i;t++){let e=n[Math.floor(a*t/i)];Array.isArray(e);for(let r of e){let{country:e,yStart:a,yEnd:n}=r,i=l[e];i||(i={id:e,strips:[]},l[e]=i),i.strips.push([t,Math.floor(s*a/o),Math.floor(s*n/o)])}}},clearBackground:t=>{r.fillStyle=t,r.fillRect(0,0,e.width,e.height)},setCountryColor:(t,e)=>{if(country=l[t],country){r.fillStyle=e;for(let t of country.strips)r.fillRect(t[0],t[1],1,t[2]-t[1])}},getAllCountries:()=>Object.keys(l).sort(),getCanvasElement:()=>e}})();l.setRasterSize(e,r);let a=Object.freeze({setRasterSize:(t,e)=>(l.setRasterSize(t,e),a),clearBackground:t=>(l.clearBackground(t),a),setRegionColor:(t,e)=>(l.setCountryColor(t,e),a),getAllRegions:()=>l.getAllCountries(),getDomElement:()=>l.getCanvasElement(),setActiveView:e=>(t.setActiveView(e),l.refreshData(),a)});return a}})})();
